<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Js</title>
    <link rel="stylesheet" href="style.css">
    
</head>
<body>
    <div class="container">
        <div class="login">
            <h1>Crear Usuario</h1>
            <form method="post">
                <input class="txtfield" type="text" id="id" placeholder="Identificación">
                <input class="txtfield" type="text" id="nombre" placeholder="Nombres">
                <input class="txtfield" type="text" id="apellido" placeholder="Apellidos">
                <input class="txtfield" type="text" id="direccion" placeholder="Dirección">
                <input class="txtfield" type="text" id="telefono" placeholder="Telefono">
                <div class="fecha">
                    <p>Fecha de Nacimiento</p>
                    <input class="txtfield" type="date" id="nacimiento" placeholder="Fecha de nacimiento">
                </div>
                <div class="genero">
                    <p>Genero</p>
                    <select class="select" id="genero">
                        <option value="M">M</option>
                        <option value="F">F</option>
                    </select>
                </div>
                <input class="txtfield" type="text" id="usuario" placeholder="Usuario" required>
                <input class="txtfield" type="password" id="password" placeholder="Contraseña" required>
                <div align="center">
                    <button class="btn" type="button" id="button"">Registrar</button>
                </div>
            </form>
        </div>
    </div>
    <script>

    const button = document.getElementById('button');

    button.addEventListener('click', () => {

        const id = document.getElementById('id').value;
        const nombre = document.getElementById('nombre').value;
        const apellido = document.getElementById('apellido').value;
        const direccion = document.getElementById('direccion').value;
        const telefono = document.getElementById('telefono').value;
        const nacimiento = document.getElementById('nacimiento').value;
        const genero = document.getElementById('genero').value;
        const usuario = document.getElementById('usuario').value;
        const password = document.getElementById('password').value;

        const newUser = {
            id: id,
            nombre: nombre,
            apellido: apellido,
            direccion: direccion,
            telefono: telefono,
            nacimiento: nacimiento,
            genero: genero,
            usuario: usuario,
            password: password
        }

        fetch('http://localhost:3000/register', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(newUser)
        })
        .then(res => res.json())
        .then(data => {
            console.log(data);
            if (data.status === 'ok'){

                alert('Usuario creado con exito');
                window.location.href = 'http://localhost/loginJS/';

            } else if (data.status === 'error'){

                alert('Usuario existente, inserte otro usuario');

            }
        });
    });
    

    </script>
</body>
</html>